// @hoge1e3/ref-input
import EventManager from "@hoge1e3/dom-mutable-events";
const evm=new EventManager();
const refevs=new WeakMap();//ref=>Set<id>
export function refInput(r,dom){
  const id=dom.getAttribute("id");
  if(!id)throw new Error(" refInput requires id");
  dom.value=r.value;
  evm.add(dom,"input",function (){
      r.value=this.value;
  });
  let refev=refevs.get(r);
  if(!refev){
    refev=new Set();
    refevs.set(r,refev);
  }
  if(!refev.has(id)){
    r.on("change",()=>
      document.getElementById(id).value=r.value
    );
    refev.add(id);
  }
  return dom;
}
