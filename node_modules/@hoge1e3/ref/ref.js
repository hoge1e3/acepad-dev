// @hoge1e3/ref
import {EventHandler} from "@hoge1e3/events";
export function ref(val){
    const r=EventHandler.attachTo({
      get(){
          return val;
      },
      set(n){
          const prev=val;
          val=n;
          r.fire("change",{
              prev,val,
          });
      },
    });
    return r;
}
export function computed(...args){
    const f=args.pop();
    let val;
    function h(){
        const prev=val;
        val=f(...args.map((r)=>r.get()));
        res.fire("change",{prev,val});
    }
    for(let r of args){
        r.on("change",h);
    }
    const res=EventHandler.attachTo({
      get(){
          return val;
      },
    });
    h();
    return res;

}