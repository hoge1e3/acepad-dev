// acepad-idb
import {KeyValueStore} from "./kvs.js";

const store = new KeyValueStore('acepad', 'zip');
await store.init();
const tmp="/tmp/idb/";
export async function save(sh){
    const dir=sh.resolve("./");
    const key=dir.path();
    const r=Math.random()+".zip";
    const zip=sh.resolve(tmp).rel(r);
    await sh.zip(dir,zip);
    await store.set(key,zip.dataURL());    
}
export async function load(sh){
    const dir=sh.resolve("./");
    const key=dir.path();
    const dataURL=await store.get(key);
    console.log("dataURL",dataURL);
    const r=Math.random();
    const zip=sh.resolve(tmp).rel(r+".zip");
    zip.dataURL(dataURL);
    await sh.unzip(zip,key);
}
