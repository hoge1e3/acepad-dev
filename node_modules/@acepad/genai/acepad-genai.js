// acepad-genai
import {post} from "user-gesture";
import {sessionInfo} from "@acepad/sessions";
export function promptgen(t,f){
    return `This is an incomplete code fragment ${f?"in "+f.name():""}.
guess the code by comments and function/method/class names.

${t}
`;
}
export function promptfix(t,f){
    return `This is a code fragment ${f?"in "+f.name():""}.
fix the code by reading comments.

${t}
`;
}
export function gen(sh){
    return gen2(sh,promptgen);
}
export function gen2(sh,prompt){
    let acepad=sh.$acepad;
    let file;
    let editor=acepad.getMainEditor();
    let i=sessionInfo(editor.session);
    if(i.file){
        file=i.file;
    }
    let t=editor.getSelectedText()||"";
    const pr=prompt(t, file);
    const url=process.env.genai||"https://chatgpt.com";
    post(()=>{
        navigator.clipboard.writeText(pr);
        window.open(url); 
    });
}
export function fix(sh){
    return gen2(sh,promptfix);
   
}