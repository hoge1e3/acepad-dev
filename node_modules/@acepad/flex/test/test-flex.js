import * as flex from "@acepad/flex";
import * as assert from "assert";
import {createProxy} from "@acepad/worker";
import {search,init} from "../flex-worker-client.js";

export async function main(){
  await init(this);
  for await (let r of search(
    ["function","test"].join(" "),
    this.resolve(this.$home))){
    this.echo(r.file);
    const lines=this.resolve(r.file).text().split("\n");
    //console.log("r",lines);
    for(let {row} of r.lines){
      this.echo(row,lines[row]);
    }
  }
  
}
function tostt(){
  
}
export async function main2(){
    const p=await createProxy(this.resolve("./flex-worker.js"),{
      send(...a){
        console.log("sent",a);
      }
    });
    p.initDb(this.$home);
    const r=await p.main("resolve",this.$home);
    console.log("res",r);
}    
