import ignore from 'ignore';
import { Ref, CommitEntry, Conflict, GitObject, Hash, ObjectType, TreeDiffEntry, TreeEntry, BranchName, PathInRepo, FilePath } from './types.js';
export declare class Repo {
    gitDir: FilePath;
    constructor(gitDir: FilePath);
    toFilePath(pathInRepo: PathInRepo): FilePath;
    private getObjectPath;
    readObject(hash: Hash): Promise<GitObject>;
    writeObject(type: ObjectType, content: Uint8Array): Promise<Hash>;
    readBlobAsText(hash: Hash): Promise<string>;
    readTree(hash: Hash): Promise<TreeEntry[]>;
    encodeTree(entries: TreeEntry[]): Buffer;
    writeTree(entries: TreeEntry[]): Promise<Hash>;
    buildTreeFromWorkingDir(): Promise<TreeEntry[]>;
    workingDir(): FilePath;
    readCommit(hash: Hash): Promise<CommitEntry>;
    encodeCommit(entry: CommitEntry): Buffer;
    writeCommit(entry: CommitEntry): Promise<Hash>;
    readHead(ref: Ref): Promise<Hash | null>;
    traverseTree(entries: TreeEntry[], prefix?: PathInRepo): AsyncGenerator<{
        path: PathInRepo;
        hash: Hash;
        content?: Buffer;
    }>;
    updateHead(ref: Ref, hash: Hash): Promise<void>;
    findMergeBase(commitHashA: Hash, commitHashB: Hash): Promise<Hash>;
    diffTreeRecursive(oldTree: TreeEntry[], newTree: TreeEntry[], prefix?: PathInRepo): Promise<TreeDiffEntry[]>;
    threeWayMerge(baseTree: TreeEntry[], aTree: TreeEntry[], bTree: TreeEntry[]): Promise<{
        toA: TreeDiffEntry[];
        toB: TreeDiffEntry[];
        conflicts: Conflict[];
    }>;
    checkoutTreeToDir(treeHash: Hash, dirPath: FilePath): Promise<void>;
    getCurrentBranchName(): Promise<BranchName>;
    headPath(): string;
    setCurrentBranchName(branch: BranchName): Promise<void>;
    readMergeHead(): Promise<Hash | null>;
    writeMergeHead(commitHash?: Hash): Promise<void>;
    applyDiff(diffs: TreeDiffEntry[]): Promise<void>;
}
export declare class RecursiveGitIgnore {
    stack: {
        dir: FilePath;
        ig: ignore.Ignore;
    }[];
    ignores(file: FilePath): boolean;
    push(dir: FilePath): void;
    pop(): void;
}
export declare function stripCR(content: Buffer<ArrayBufferLike>): Uint8Array<ArrayBufferLike>;
