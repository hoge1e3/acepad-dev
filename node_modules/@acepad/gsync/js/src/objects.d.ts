import { FilePath, Hash } from "./types.js";
import MutablePromise from "mutable-promise";
export type ObjectValue = {
    content: Uint8Array;
    mtime: Date;
};
export type ObjectEntry = {
    hash: Hash;
} & ObjectValue;
export interface ObjectStore {
    has(hash: Hash): Promise<boolean>;
    get(hash: Hash): Promise<ObjectValue>;
    put(hash: Hash, compressed: Uint8Array): Promise<void>;
    iterate(since: Date): AsyncGenerator<ObjectEntry>;
}
export declare function factory(gitDir: FilePath): Promise<ObjectStore>;
export declare class IndexedDBBasedObjectStore implements ObjectStore {
    dbName: string;
    private db;
    dbInit: MutablePromise<IDBDatabase>;
    constructor(dbName: string);
    has(hash: Hash): Promise<boolean>;
    get(hash: Hash): Promise<ObjectValue>;
    put(hash: Hash, compressed: Uint8Array): Promise<void>;
    iterate(since: Date): AsyncGenerator<ObjectEntry>;
}
export declare class FileBasedObjectStore implements ObjectStore {
    path: FilePath;
    constructor(path: FilePath);
    private pathOf;
    has(hash: Hash): Promise<boolean>;
    get(hash: Hash): Promise<ObjectValue>;
    put(hash: Hash, compressed: Uint8Array): Promise<void>;
    iterate(since: Date): AsyncGenerator<ObjectEntry>;
}
