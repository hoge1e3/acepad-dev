#!run 
import {getFS, require} from "petit-node";

export async function main(){
  if(!this.resolve("/tsc-idb/").exists()){

  await getFS().mountAsync("/tsc-idb","idb",{
    dbName: "tsc-idb",
    storeName: "kvStore"
  });
  }
  //this.fstab();
  
  let ts;
  try{
    if(!this.resolve("/idb/node_modules/").exists()){
      await this.ln("/tsc-idb/node_modules", "/idb/");
    }
    ts=require("typescript", this.getcwd());
    this.echo("tsc loaded");
    return tsc;
  }catch(e){
    // download tsc.zip and extract
    this.echo(e);
  }
}