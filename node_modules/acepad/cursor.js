import {getMainEditor} from './states.js';
import * as cursor from "@acepad/cursor";

export function extend(to) {
  const conv=(f)=>((...a)=>{
    //console.log("conv1",f.name, a);
    const session=parseSession(a);
    a.unshift(session);
    //console.log("conv2",f.name, a);
    return f(...a);
  });
  const convO=(o, to)=>{
    for (let k in o) {
      const f=o[k];
      if (typeof f!=="function") continue;
      to[k]=conv(f);
    }
  };
  convO(cursor, to);
  //get  save bottom lineEnd;
  for (var k in cursor.locate) {
    //console.log(k);
    to.locate[k]=conv(cursor.locate[k]);
  }
}
function parseSession(a){
    const editor=getMainEditor();
    let session=editor.session;
    if(isSession(a[0]))session=a.shift();
    return session;
}
function isSession(s){
    return s instanceof window.ace.EditSession;
}
