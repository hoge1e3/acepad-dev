


<div id="editor" style="width: 500px; height:400px;"></div>
<script src="https://cdn.jsdelivr.net/npm/ace-builds@1.39.0/src-noconflict/ace.js"></script>
<script type="module">
import {init, addCommandsToSession, addGlobalCommands, addLocalCommands} from "../ace-local-commands.js";
const editor=ace.edit(document.querySelector("#editor"));
window.editor=editor;
init(editor);
const sessions=[];
function insert(str){
    editor.onTextInput(str);
}
addGlobalCommands(editor,{
    "gbl1": {
        bindKey:"ctrl-1",
        exec(){insert("global1");}
    },
    "gbl2": {
        bindKey:"ctrl-2",
        exec(){insert("global2");}
    },
    "switch": {
        bindKey:"ctrl-s",
        exec(){
            const i=sessions.indexOf(editor.session);
            const ns=sessions[(i+1)%sessions.length];
            editor.setSession(ns);
        }
    }
});
editor.session.setValue(`[Global]
ctrl-1: cmd1
ctrl-2: cmd2
ctrl-s: switch sessions
`);
sessions.push(editor.session);
const s1=new ace.EditSession(`[Session 1]
ctrl-1: local1
ctrl-3: local3
(And global commands)
`);
sessions.push(s1);
addCommandsToSession(s1, {
    "lcl1": {
        bindKey:"ctrl-1",
        exec(){insert("local1");}
    },
    "lcl3": {
        bindKey:"ctrl-3",
        exec(){insert("local3");}
    },
});

const s2=new ace.EditSession(`[Session 2]
ctrl-2: local2
ctrl-3: local3-2
ctrl-4: local4
(And global commands)
`);
sessions.push(s2);
addCommandsToSession(s2, {
    "lcl2": {
        bindKey:"ctrl-2",
        exec(){insert("local2");}
    },
    "lcl3-2": {
        bindKey:"ctrl-3",
        exec(){insert("local3-2");}
    },
    "lcl4": {
        bindKey:"ctrl-4",
        exec(){insert("local4");}
    },
});


</script>