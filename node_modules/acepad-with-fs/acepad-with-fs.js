// acepad-with-fs
import {open} from "acepad-browser";
import {trial,debugSession} from "acepad-debug";
import {showWidget} from "acepad-widget";
import {initVConsole,showVConsole} from "show-vconsole";
import {run} from "acepad-find";

export async function main(){
    const sh=this;
    let acepad=window.acepad=await 
    (await sh.jsm("acepad")).init();   
    sh.$acepad=window.acepad;
    let {openFile}=await sh.jsm("acepad-files");
    openFile(sh,"./");
    debugSession(sh);
    acepad.attachCommands({
        "ctrl-r":()=>location.reload(),
        showDebug:{bindKey:"ctrl-d",exec(){
            acepad.changeSession("*debug*");
        }},
        find:{
            bindKey:"ctrl-f",
            exec(){
                run(sh);
            }
        }
    });
    sh.resolve(".").recursive((f)=>{
        if(f.ext()!==".js")return ;
        let s=f.text();
        acepad.addToNgram(s);
    });
    initVConsole();
    acepad.showMenuButtons({
        cons(){
            showVConsole();
        }
    });
    acepad.events.on("keyclick",({b})=>{
        console.log("k",b.innerText);
    });
}